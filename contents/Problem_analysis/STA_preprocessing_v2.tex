\section{State of the Art in MRI Preprocessing} \label{art}

In \secref{sec:noise} the various types of corrupting noise was presented. Continuous efforts have been made to avoid, remove and limit the influence of artifactual contributors present in the BOLD signal before initiating statistical analyses. Standard preprocessing methods of rigid-body motion correction, slice timing correction, spatial smoothing and temporal filtering, have for long been a part of the preprocessing toolbox \cite{Poldrack2011,Salimi-Khorshidi2014}. However, as fMRI studies grow more complex and seek greater signal-to-noise ratio using higher tesla scanner, sources of noise might become more accentuated. Thereby, a need for more complex and fitting cleanup tools to add to the preprocessing toolbox is present. \cite{Wood2012,Liu2006} \\
In noise removal of fMRI datasets, there are mainly two widely used approaches: one data-driven and one model-based \cite{Salimi-Khorshidi2014,Iraji2016}. In the latter, mainly physiological fluctuations of non-interest, recorded with additional devices during MRI acquisition, are modeled and controlled for as nuisance regressors during analysis in the general linear model. These are e.g. heart rate and breathing cycle. Furthermore, models representing fluctuations in cerebral spinal fluid (CSF) and white matter are also incorporated as regressors of non-interest. \cite{Salimi-Khorshidi2014,Iraji2016,Monti2011} Data-driven models instead draw upon the data within the MRI dataset utilizing methods of principal component analysis (PCA) and independent component analysis (ICA). Data-driven methods are ideal when no optimal modeling of noise can be made into regressors of non interest as they can analyze the data in a more flexible way. Hence, they are able to identify new and unexpected noise components, as well as describing the known sources of noise more precisely. Subsequently, these noise sources can be controlled for and removed . \cite{Iraji2016} As mentioned, model-based noise cleanup methods that depends on external physiological measurements mainly focus on removal of physiological noise. This suggests that methods which can incorporate a higher level of motion correction along with correction for MRI scanner artifacts might be of greater use. \\
%
%One of the most used model-based method is the RETROspective Image CORrection (RETROICOR), introduced by Glover et al. \cite{Glover2000}. By measuring the phases of respiratory and cardiac cycles and comparing these to the fourier terms of the fMRI scan, they showed that it was possible to find these physiologic noise contributions which was synchronized with the scan. These could then be out-filtered showing considerably lowered peaks in the frequency spectrum at 0.8 Hz for cardiac influence and 0.15 Hz for respiratory influence. \cite{Glover2000} \\
%A limitation of the model-based RETROICOR is its dependency on physiologic data being acquired from external devices and thereby not reliant to counter for unexpected noise sources. A study by Behzadi et al. \cite{Behzadi2013} surpassed this restriction by utilizing a proposed data-driven model of Component based noise Correction (CompCor). Instead of relying on data from external measurement of physiological noise, the CompCor method uses a PCA derived from noise regions of interest (ROI) to describe the physiological noise. Two methods of determining noise ROI’s were introduced: one using anatomical data to identify voxels where no neurological activity is presumed, such as in the white matter and the CSF, the other defining noise ROI’s from voxels with high temporal standard deviation (tSTD) as these were found to correspond to ventricles, edge-regions, and vessels. The first five components from the PCA were hypothesized to describe the variance of the noise, and were used to fit in a general linear model as nuisance regressors and thereby remove the noise influence. Both CompCor methods produced a significant reduction in physiological noise fluctuations compared to the RETROICOR for BOLD fMRI. In addition, the second CompCor method was able to reduce subject motion artifacts. Though in cases of both severe motion artifacts and physiological fluctuations the PCA might only be able to describe one of these factors, limiting its use. \cite{Behzadi2013} \\
ICA is a data-driven model, building on the blind source separation paradigm for exploratory source analysis of fMRI datasets, and was first introduced in 1998 by Mckeown et al. \cite{Mckeown1998}. Since then, multiple studies \cite{Calhoun2001a,Deslauriers2017,Parkes2018,Du2018,Tohka2008} have used and developed the use of ICA further for exploratory analysis of sources in the recorded fMRI signal. ICA has proven to be a powerful tool in separating the different sources which in summation comprise the complete fMRI scan. By maximizing spatial independence and non-gaussianity, the data can be decomposed into components each consisting of an activation map and its corresponding time course and power spectrum. \cite{Salimi-Khorshidi2014} Having these three parameters made it possible to both qualitatively and quantitatively asses the components, making it possible to discriminate between artifactual activation and task-related activation. Tools for easy use of the ICA have been presented by groups like the Oxford University Centre for Functional MRI of the Brain (FMRIB), who presented a tool called Multivariate Exploratory Linear Optimized Decomposition into Independent Components (MELODIC) for fast ICA implementation. MELODIC is a newer and more sophisticated method of ICA incorporating a probabilistic approach optimizing the estimation of independent sources. \cite{FMRIB2016} The possibility of visually inspecting and labeling components as either artifactual or of interest, leads to discussions on standardization and comparability, as labeling of components could be subjected to operator biasing. Studies \cite{Salimi-Khorshidi2014,Griffanti2017} have proposed ways to recognize different artifactual components, but these can be hard to utilize since every component will express different characteristics. Subsequently, automatic labeling algorithms have been made as guidelines to increase the sensibility, reliability and reproducibility of fMRI results. These have been made by training classifiers in recognizing and separating artifactual components. \cite{Tohka2008} \\
In 2014, Salimi-Khorshidi et al. \cite{Salimi-Khorshidi2014} introduced the FMRIB's ICA-based X-noiseifier (FIX) for automatic denoising of resting state and task-related fMRI data. This method employs an initial standard preprocessing followed by MELODIC, hand labeling of a training set, extraction of 186 features and training and employment of a classifier. The subsequent classified noise components can then be removed from the dataset, resulting in a denoised dataset. FIX was developed and tested on resting state fMRI and yielded an overall classification accuracy of 95$\percent$ on standard quality resting state data, and 99$\percent$ on high quality resting state data. \cite{Salimi-Khorshidi2014}   \\
The use of probabilistic ICA and classifiers is an interesting proposal as it makes way for a more standardized approach, and reduces the labor intense work of labeling all components in studies with large datasets. Because the experience of pain results in complex activation of multiple centers of the brain, along with great risk of stimulus related movements, it would be of profound interest to compare the performance FIX to the standard approach of noise removal in task-related noxious stimuli events.     
%Despite the present implemented solutions for noise removal, none of the following have, to the authors current knowledge, been used and tested for noise removal in pain activation associated studies. Because the experience of pain result in activation of multiple centers of the brain, along with great risk of stimulus related movements, it would be of profound interest to compare some of the available solution in this field.  
