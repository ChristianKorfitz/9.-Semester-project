\section{State of the Art in MRI Preprocessing} \label{art}

In \secref{sec:noise} the various types of corrupting noise was presented. Continuous efforts have been made to avoid, remove and limit the influence of artifactual contributors before the quantitative fMRI analysis. Regular standard preprocessing methods of rigid-body motion correction, spatial smoothing and temporal filtering, have for long been a part of the preprocessing toolbox \cite{Poldrack2011,Salimi-Khorshidi2014}. But as studies grow more complex, seek greater SNR and introduce greater noise sources associated with the newer scanners, the need for more complex and fitting cleanup tools to add to the preprocessing toolbox is present. \cite{Wood2012,Liu2006} \\
In noise removal of fMRI datasets, there are mainly two widely used approaches: one data driven and one model based \cite{Salimi-Khorshidi2014,Iraji2016}.  In the latter, acquired data is compared to a predefined model, such as in the general linear model. These methods include additional physiological recordings, e.g. heart rate and breathing cycle, and use these regressors of non interest to regress/filter out their contribution to the recorded fMRI dataset. \cite{Salimi-Khorshidi2014,Iraji2016,Monti2011} Data driven models instead draw upon the data within the dataset utilizing methods of principal component analysis (PCA) and independent component analysis (ICA). Data driven methods are ideal when no good existing model fits the data as they can analyze the data in more flexible way. Hence, they are able to identify new and unexpected noise components, which then can be made to fit the model, thereby laying the foundation for a model based noise removal. \cite{Iraji2016} \\
One of the most often referred to articles making use of a model based method is the RETROspective Image CORrection (RETROICOR), introduced by Glover et al. \cite{Glover2000}. By measuring the phases of respiratory and cardiac cycles and comparing these to the fourier terms of the fMRI scan, they showed that it was possible to find these physiologic noise contributions which was synchronized with the scan. These could then be out-filtered showing considerably lowered peaks in the frequency spectrum at 0.8 Hz for cardiac influence and 0.15 Hz for respiratory influence. \cite{Glover2000} \\
A limitation of the model based RETROICOR was its dependency on physiologic data being acquired from external devices. A study by Behzadi et al. \cite{Behzadi2013} surpassed this restriction by utilizing a proposed data driven model of Component based noise Correction (CompCor). Instead of relying on data from external measurement of physiological noise, the CompCor method uses a PCA derived from noise regions of interest (ROI) to describe the physiological noise. Two methods of determining noise ROI’s were introduced: one using anatomical data to identify voxels where no neurological activity is presumed, such as in white matter and cerebrospinal fluid (CSF), the other defining noise ROI’s from voxels with high temporal standard deviation (tSTD) as these were found to correspond to ventricles, edge-regions, and vessels. The first five components from the PCA were hypothesized to describe the variance of the noise, and were used to fit a general linear model as nuance regressors and thereby remove the noise influence. Both CompCor methods produced a significant reduction in physiological noise fluctuations compared to the RETROICOR for BOLD fMRI. In addition, the second CompCor method was able to reduce subject motion artifacts. Though in cases of both severe motion artifacts and physiological fluctuations the PCA might only be able to describe one of the factors, limiting its use. \cite{Behzadi2013} \\
Model based noise cleanup methods like RETROICOR depend on external physiological measurements, and both the PCA based method CompCor and RETROICOR mainly focuses on physiological noise. This suggest that methods which can incorporate a higher level of motion correction along with correction for MRI scanner artifacts might be of greater use. \\
ICA is another data driven model, building on the blind source separation paradigm, for source analysis of fMRI datasets and was first introduced in 1998 by Mckeown et al. \cite{Mckeown1998}. Since then, multiple studies \cite{Calhoun2001a,Deslauriers2017,Parkes2018,Du2018,Tohka2008} have used and developed the use of ICA further. ICA has proven to be a powerful tool in separating the different sources which in summation comprise the complete fMRI scan. By maximizing spatial independence and non-gaussianity, the data can be decomposed into components each consisting of an activation map and its corresponding time course. \cite{Salimi-Khorshidi2014} This facilitated the prospect of by visually inspecting the components, a discrimination between artifactual activation and task-related could be made. Tools for easy employment of the ICA has been presented by groups like the Oxford University Centre for Functional MRI of the Brain (FMRIB), who presented a program called Multivariate Exploratory Linear Optimized Decomposition into Independent Components (MELODIC) for fast ICA implementation. \cite{FMRIB2016} The possibility of visually inspecting and labeling components as either artifactual or of interest, lead to discussions on standardization and comparability, as labeling of components could be subjected to operator biasing. Studies in the likes of \cite{Salimi-Khorshidi2014,Griffanti2017}, have proposed ways to recognize different artifactual components, but these can be hard to utilize since every component will be different from another. Subsequently, automatic labeling algorithms have been made to increase the sensibility, reliability and reproducibility of fMRI studies. These have been made by training classifiers in recognizing and separating artifactual components. \cite{Tohka2008} \\
In 2014 Salimi-Khorshidi et al. \cite{Salimi-Khorshidi2014} introduced the FMRIB's ICA-based X-noiseifier (FIX), for automatic denoising of resting state and task-related fMRI data. This methods employ the use an initial standard processing followed by a spatial-temporal fastICA, hand labeling of training set, feature extraction of 180 features and a heracial classifier for classification. \cite{Salimi-Khorshidi2014} \\
The use of pattern recognition is an interesting proposal as it makes way for a standardized approach, and reduces the labor intense work of labeling all components.   

%Despite the present implemented solutions for noise removal, none of the following have, to the authors current knowledge, been used and tested for noise removal in pain activation associated studies. Because the experience of pain result in activation of multiple centers of the brain, along with great risk of stimulus related movements, it would be of profound interest to compare some of the available solution in this field.  
